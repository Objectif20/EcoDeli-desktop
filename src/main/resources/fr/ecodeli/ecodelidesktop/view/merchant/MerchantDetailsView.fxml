<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.*?>
<?import javafx.geometry.Insets?>

<AnchorPane xmlns:fx="http://javafx.com/fxml" fx:controller="fr.ecodeli.ecodelidesktop.merchant.MerchantDetailsController">
    <children>
        <!-- Header avec bouton retour -->
        <HBox alignment="CENTER_LEFT" spacing="20" AnchorPane.topAnchor="10" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20">
            <Button fx:id="retourButton" text="⬅ Retour" onAction="#handleRetour" style="-fx-font-size: 14px; -fx-padding: 8 16;"/>
            <Label fx:id="titleLabel" text="Détails du Commerçant" style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
        </HBox>

        <!-- Contenu principal -->
        <ScrollPane AnchorPane.topAnchor="60" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20" AnchorPane.bottomAnchor="20" fitToWidth="true">
            <content>
                <VBox spacing="20">
                    <padding>
                        <Insets top="10" right="10" bottom="10" left="10"/>
                    </padding>

                    <!-- Informations personnelles -->
                    <VBox spacing="15" style="-fx-background-color: #f8f9fa; -fx-background-radius: 8; -fx-padding: 20;">
                        <Label text="Informations Personnelles" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>

                        <GridPane hgap="20" vgap="15">
                            <columnConstraints>
                                <ColumnConstraints minWidth="150" prefWidth="150"/>
                                <ColumnConstraints minWidth="200" prefWidth="300"/>
                                <ColumnConstraints minWidth="150" prefWidth="150"/>
                                <ColumnConstraints minWidth="200" prefWidth="300"/>
                            </columnConstraints>

                            <Label text="ID:" style="-fx-font-weight: bold;" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                            <Label fx:id="idLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                            <Label text="Prénom:" style="-fx-font-weight: bold;" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                            <Label fx:id="firstNameLabel" text="-" GridPane.columnIndex="3" GridPane.rowIndex="0"/>

                            <Label text="Nom:" style="-fx-font-weight: bold;" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                            <Label fx:id="lastNameLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                            <Label text="Email:" style="-fx-font-weight: bold;" GridPane.columnIndex="2" GridPane.rowIndex="1"/>
                            <Label fx:id="emailLabel" text="-" GridPane.columnIndex="3" GridPane.rowIndex="1"/>

                            <Label text="Téléphone:" style="-fx-font-weight: bold;" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                            <Label fx:id="phoneLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                            <Label text="Ville:" style="-fx-font-weight: bold;" GridPane.columnIndex="2" GridPane.rowIndex="2"/>
                            <Label fx:id="cityLabel" text="-" GridPane.columnIndex="3" GridPane.rowIndex="2"/>
                        </GridPane>
                    </VBox>

                    <!-- Informations entreprise -->
                    <VBox spacing="15" style="-fx-background-color: #e8f5e8; -fx-background-radius: 8; -fx-padding: 20;">
                        <Label text="Informations Entreprise" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>

                        <GridPane hgap="20" vgap="15">
                            <columnConstraints>
                                <ColumnConstraints minWidth="150" prefWidth="150"/>
                                <ColumnConstraints minWidth="200" prefWidth="300"/>
                                <ColumnConstraints minWidth="150" prefWidth="150"/>
                                <ColumnConstraints minWidth="200" prefWidth="300"/>
                            </columnConstraints>

                            <Label text="Nom de l'entreprise:" style="-fx-font-weight: bold;" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                            <Label fx:id="companyNameLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                            <Label text="Adresse:" style="-fx-font-weight: bold;" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                            <Label fx:id="addressLabel" text="-" wrapText="true" GridPane.columnIndex="3" GridPane.rowIndex="0"/>
                        </GridPane>
                    </VBox>

                    <!-- Informations abonnement -->
                    <VBox spacing="15" style="-fx-background-color: #fff3cd; -fx-background-radius: 8; -fx-padding: 20;">
                        <Label text="Informations Abonnement" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>

                        <GridPane hgap="20" vgap="15">
                            <columnConstraints>
                                <ColumnConstraints minWidth="150" prefWidth="150"/>
                                <ColumnConstraints minWidth="200" prefWidth="300"/>
                                <ColumnConstraints minWidth="150" prefWidth="150"/>
                                <ColumnConstraints minWidth="200" prefWidth="300"/>
                            </columnConstraints>

                            <Label text="Type d'abonnement:" style="-fx-font-weight: bold;" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                            <Label fx:id="subscriptionLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                            <Label text="Nb. demandes de livraison:" style="-fx-font-weight: bold;" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                            <Label fx:id="deliveryRequestsLabel" text="-" GridPane.columnIndex="3" GridPane.rowIndex="0"/>
                        </GridPane>
                    </VBox>

                    <!-- Section contrat PDF -->
                    <VBox fx:id="contractSection" spacing="15" style="-fx-background-color: #f0f8ff; -fx-background-radius: 8; -fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="15">
                            <Label text="Contrat" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                            <Button fx:id="downloadButton" text="📥 Télécharger" onAction="#handleDownloadContract" style="-fx-font-size: 12px;"/>
                            <Button fx:id="refreshPdfButton" text="🔄 Actualiser" onAction="#handleRefreshPdf" style="-fx-font-size: 12px;"/>
                            <Separator/>
                            <Label fx:id="pageLabel" text="Page 1 / 1" style="-fx-font-size: 12px;"/>
                            <Button fx:id="prevPageButton" text="◀" onAction="#handlePrevPage" style="-fx-font-size: 12px;" disable="true"/>
                            <Button fx:id="nextPageButton" text="▶" onAction="#handleNextPage" style="-fx-font-size: 12px;" disable="true"/>
                            <Separator/>
                            <Button fx:id="zoomInButton" text="🔍+" onAction="#handleZoomIn" style="-fx-font-size: 12px;"/>
                            <Button fx:id="zoomOutButton" text="🔍-" onAction="#handleZoomOut" style="-fx-font-size: 12px;"/>
                            <Label fx:id="zoomLabel" text="100%" style="-fx-font-size: 12px;"/>
                        </HBox>

                        <StackPane style="-fx-border-color: #ddd; -fx-border-width: 1; -fx-background-color: white;">
                            <ScrollPane fx:id="pdfScrollPane" fitToWidth="true" fitToHeight="true" prefHeight="600">
                                <ImageView fx:id="pdfImageView" preserveRatio="true" smooth="true"/>
                            </ScrollPane>
                            <VBox fx:id="noPdfMessage" alignment="CENTER" spacing="10" style="-fx-background-color: #f8f9fa;">
                                <Label text="📄" style="-fx-font-size: 48px;"/>
                                <Label text="Aucun contrat disponible" style="-fx-font-size: 16px; -fx-text-fill: #6c757d;"/>
                            </VBox>
                        </StackPane>
                    </VBox>
                </VBox>
            </content>
        </ScrollPane>

        <!-- Loading indicator -->
        <StackPane fx:id="loadingPane" visible="false" AnchorPane.topAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.bottomAnchor="0" style="-fx-background-color: rgba(0,0,0,0.5);">
            <VBox alignment="CENTER" spacing="10" style="-fx-background-color: white; -fx-background-radius: 8; -fx-padding: 30;">
                <ProgressIndicator/>
                <Label text="Chargement en cours..." style="-fx-font-size: 14px;"/>
            </VBox>
        </StackPane>
    </children>
</AnchorPane>